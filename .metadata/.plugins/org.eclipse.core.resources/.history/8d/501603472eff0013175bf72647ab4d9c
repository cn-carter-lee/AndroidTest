package com.pys.hellogridview;

import java.io.InputStream;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.AsyncTask;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.GridView;
import android.widget.ImageView;

public class ImageAdapter extends BaseAdapter {
	private Context mContext;

	public ImageAdapter(Context c) {
		mContext = c;
	}

	public int getCount() {
		return mThumbIds.length;
	}

	public Object getItem(int position) {
		return null;
	}

	public long getItemId(int position) {
		return 0;
	}

	// create a new ImageView for each item reference by the Adapter
	public View getView(int position, View convertView, ViewGroup parent) {
		ImageView imageView;
		if (convertView == null) { // if it's not recycled, initialize some
									// attributes
			imageView = new ImageView(mContext);
			imageView.setLayoutParams(new GridView.LayoutParams(135, 135));
			imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
			imageView.setPadding(8, 8, 8, 8);
			imageView.setBackgroundColor(0X000000);
		} else {
			imageView = (ImageView) convertView;
		}

		imageView.setImageResource(mThumbIds[position]);

		new DownloadImageTask(imageView)
				.execute("http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg");

		return imageView;
	}

	// reference to our images
	private Integer[] mThumbIds = { R.drawable.sample_2, R.drawable.sample_3,
			R.drawable.sample_4, R.drawable.sample_5, R.drawable.sample_6,
			R.drawable.sample_7, R.drawable.sample_0, R.drawable.sample_1,
			R.drawable.sample_2, R.drawable.sample_3, R.drawable.sample_4,
			R.drawable.sample_5, R.drawable.sample_6, R.drawable.sample_7,
			R.drawable.sample_0, R.drawable.sample_1, R.drawable.sample_2,
			R.drawable.sample_3, R.drawable.sample_4, R.drawable.sample_5,
			R.drawable.sample_6, R.drawable.sample_7

	};

	private String[] mThumbUrls = {
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg",
			"http://img5.cache.netease.com/photo/0005/2014-06-24/9VGU91CO5O2Q0005.jpg" };

	private class DownloadImageTask extends AsyncTask<String, Void, Bitmap> {
		ImageView bmImage;

		public DownloadImageTask(ImageView bmImage) {
			this.bmImage = bmImage;
		}

		protected Bitmap doInBackground(String... urls) {
			String urldisplay = urls[0];
			Bitmap mIcon11 = null;
			try {
				InputStream in = new java.net.URL(urldisplay).openStream();
				mIcon11 = BitmapFactory.decodeStream(in);
			} catch (Exception e) {
				Log.e("Error", e.getMessage());
				e.printStackTrace();
			}
			return mIcon11;
		}

		protected void onPostExecute(Bitmap result) {
			bmImage.setImageBitmap(result);
		}
	}
}
